Обратная матрица - это такая матрица, что при умножении обычной на нее получится единичная матрица. Обратная матрица для матрицы $A$ обозначается как $A^{-1}$.
$$A^{-1}A = AA^{-1} = E$$
Проведите параллели с обычными числами: для любого числа (кроме нуля) существует ему обратное, такое что при их умножении получается единица:
$$5^{-1}5 = \frac55 = 1$$
Обратные матрицы по определению коммутативны с оригинальной на умножении, поэтому существуют только квадратные матрицы (и $A^{-1}A$, и $AA^{-1}$ должны давать матрицу одинакого размера, что возможно только когда перемножаемые матрицы одинакого размера).
Однако, существуют производные понятия "левой обратной матрицы" $(A^{L}A = E)$ и "правой обратной матрицы" $(AA^R = E)$, для которых условие на квадратность уже не обязательно, но такие мы рассматривать не будем. Если матрица одновременно левая и правая обратная, она считается обратной в целом.

## Существование и единственность
- Если $A^{-1}$ существует, то такая матрица единственна. Это свойство не применяется для "левой" и "правой" обратных матриц.
  Допустим, что это не так, и существует две матрицы $X_1$ и $X_2$, обратные для $A$, то есть $X_1A = AX_1 = E$ и $X_2A=AX_2=E$. Тогда, $$X_1 = X_1 E = X_1(AX_2) = (X_1A)X_2 = EX_2 = X_2$$
  А значит, эти две матрицы равны.
- $(A^{-1})^{-1} = A$. Естественно, для обратной матрицы, обратной будет оригинальная. $$A^{-1}(A^{-1})^{-1} = E = AA^{-1}$$
- Обратная матрица $A^{-1}$ существует только когда $\det A \neq 0$.
  Геометрически можно понять следующим образом: если $A$ описывает какую-то трансформацию пространства, то $A^{-1}$ выполняет трансформацию, которая восстанавливает пространство в изначальное состояние. Если $\det A =0$, то эта трансформация сожмет пространство в меньшее измерение - множество точек будут спроектированны в одну. Для этого обратной матрице потребовалось бы разбить точку сразу в целое множество изначальных точек, а этого умножение добиться не может (тогда получится не функция, ведь одна точка будет соответствовать целому множеству точек).
  Для доказательства требуется теория из следующего билета [[#44. Элементарные преобразования. Элементарные матрицы.]]
  Если матрица $A$ вырождена, то любое произведение $AB$ тоже будет вырождено, а единичная матрица не является вырожденой. Из этого следует, что для вырожденной матрицы не существует обратной.
  Если матрица $A$ не вырождена, то с помощью элементарных матриц ее возможно привести к единичной матрице: $$T_M\ldots T_2T_1A = E$$
  Произведение всех элементарных матриц $T_M\ldots T_2T_1 = X$ и будет являться обратной матрицой к $A$. $XA = E$. Более того, раз $X$ тоже невырожденная, и из прошлого свойства следует, что выполняется $AX = E$ в том числе.  
## Свойства обратной матрицы
- $(AB)^{-1} = B^{-1}A^{-1}$. Это свойство похоже на свойство с транспонированием. Если правая часть равенства тоже является обратной для произведения $AB$, то должна точно так же получиться единичная матрица. $$AB(B^{-1}A^{-1}) = A(BB^{-1})A^{-1} = AA^{-1} = E$$
- $(A^T)^{-1} = (A^{-1})^T$. Неважно, какую матрицу мы транспонируем. Из свойства произведения транспонирования, $(AB)^T = B^TA^T$, получаем $$\array{(AA^{-1}) = E \\(AA^{-1})^T = (A^{-1})^TA^T = E^T = E}$$
  Получается, как и $(A^T)^{-1}A^T = E$ (по определению обратной матрицы), так и $(A^{-1})^T A^T = E$. Из единственности следует наше свойство.
- $(kA)^{-1} = k^{-1}A^{-1}$, вытекает из свойства обратного элемента для чисел. $$\array{(kA)^{-1}(kA) = E \\ kAk^{-1}A^{-1} = kk^{-1}E = \frac kk E = E}$$
## Формулы для элементов обратной матрицы
Есть довольно естественный способ получить обратную матрицу: путем элементарных преобразований.
Изначально мы определили обратную матрицу, как $A^{-1}A = E$. Но раз обратная матрица не является вырожденной, ее можно представить в виде произведения элементарных матриц: $$\array{A^{-1} = T_M\ldots T_1 \\ T_M\ldots T_1A = E}$$
Но ведь это тоже самое, что и $A^{-1} = T_M\ldots T_1E$.

Получается, что те же преобразования, которые нужны, чтобы превратить матрицу $A$ в единичную, можно применить к единичной матрице, чтобы получить обратную!
Оформляется это с помощью записывания двух матриц рядом, получая матрицу размером $n \cross 2n$. Первая матрица будет исходная, вторая рядом - единичная.
$$D = (A|E) = \begin{pmatrix}a_{11} & \ldots & a_{1n} & & 1 & \ldots  & 0 \\ \vdots & \ddots & \vdots & & \vdots & \ddots & \vdots \\ a_{n1} & \ldots & a_{nn} & & 0 & \ldots & 1\end{pmatrix}$$
Путем элементарных преобразований, меняем левую часть этой двойной матрицы так, чтобы она стала равной единичной матрице:
$$\Rightarrow \begin{pmatrix}1 & \ldots & 0 &&a'_{11} & \ldots  & a'_{1n} \\ \vdots & \ddots & \vdots & & \vdots & \ddots & \vdots \\ 0 & \ldots & 1 & & a'_{n1} & \ldots & a'_{nn}\end{pmatrix} = (E|A^{-1})$$
Забираем матрицу с правой части - это и будет обратная матрица.

Однако формулы для элементов обратной матрицы скорее всего подразумевают четкие уравнения для достижения каждого элемента. Поговорим и о таких. Уравнения, на удивление, выводятся довольно адекватно!
Обратная матрица $X =A^{-1}$ служит решением матричного уравнения $AX = E$. Значит, что для $j$-того столбика для обратной матрицы будет выполняться:
$$Ax_j = e_j \Leftrightarrow A\begin{pmatrix}x_{1j} \\ \vdots  \\ x_{jj} \\ \vdots \\ x_{nj}\end{pmatrix} = \begin{pmatrix}0 \\ \vdots \\ 1 \\ \vdots \\ 0\end{pmatrix}$$
Если мы запишем это уравнение в виде СЛАУ, получим:
$$\cases{
a_{11}x_{1j} + a_{12}x_{2j} + \ldots  +a_{1n} x_{nj} = 0 \\ 
\ldots\\ 
a_{j1}x_{1j} + a_{j2}x_{2j} + \ldots  +a_{jn} x_{nj} = 1 \\ 
\ldots \\ 
a_{n1}x_{1j} + a_{n2}x_{2j} + \ldots  +a_{nn} x_{nj} = 0 \\ 
}$$
Решаем с помощью метода Крамера. Каждый $x_{ij}$ будет равен $$x_{ij} = \frac{\det A_i}{\det A}$$
Матрица $A_i$, получается заменой $i$-того столбика матрицы $A$ на вектор $e_j$. Примечательна такая замена тем, что по этому столбику теперь можно разложить определитель, и получить выражение лишь из одного минора!
$$\det A_i = \left|\array{
a_{11} & \ldots & a_{1(i-1)} & 0 & a_{1(i+1)} & \ldots & a_{1n} \\
\vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
a_{j1} & \ldots & a_{j(i-1)} & 1 & a_{j(i+1)} & \ldots & a_{jn} \\
\vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
a_{n1} & \ldots & a_{n(i-1)} & 0 & a_{n(i+1)} & \ldots & a_{nn} \\
}\right| =$$
$$= (-1)^{i+j} \det \bar A^j_i$$
Это значение - минор со знаком с "шахматной доски" - называется *алгебраическим дополнением элемента $a_{ji}$!* Сейчас мы обозначим это значение за $A^j_i$.
Соответственно $x_{ij}$ будет равен $$x_{ij} = \frac{A^j_i}{\det A}$$
Теперь, зная формулу индидуального элемента обратной матрицы, мы можем составить всю матрицу с помощью алгебраических дополнений. $\det A$ мы выносим за скобки матрицы как постоянный множитель, не зависящий от позиции элемента, и транспонируем матрицу (ибо сейчас элементу $ij$ соответствует алгебраическое дополнение $ji$):
$$A^{-1} = X = \frac{1}{\det A} \begin{pmatrix}A^1_1 & A^1_2 & \ldots & A^1_n \\ A^2_1 & A^2_2 & \ldots & A^2_n \\ \vdots & \vdots & \ddots & \vdots \\ A^n_1 & A^n_2 & \ldots & A^n_n\end{pmatrix}^T$$
Таким образом и составляется обратная матрица.
## Пример задачи
Условие: найдите матрицу, обратную данной. $$A = \pmatrix{-4 & -1 & 2 \\ 4 & 3 & 1 \\ -1 & 3 & 5}$$

Решение: первым делом, нам нужен определитель этой матрицы. Разложим по последнему столбику:
$$\array{\det A = 2\begin{vmatrix}4 & 3 \\ -1 & 3\end{vmatrix} - \begin{vmatrix}-4 & -1 \\ -1 & 3\end{vmatrix} + 5\begin{vmatrix}-4 & -1 \\ 4 & 3\end{vmatrix} = \\ = 2(12+3) - (-12-1) + 5(-12+4) = 3}$$
Теперь составляем матрицу миноров:
$$M = \pmatrix{15-3 & 20+1 & 12+3 \\ -5-6 & -20+2 & -12-1 \\ -1-6 & -4-8 & -12+4}$$
Чтобы превратить матрицу миноров в матрицу алгебраических дополнений, умножаем на знаки в соответствии с шахматной доской (меняем знаки на "черных клетках"). В конце транспонируем и делим на определитель оригинальной матрицы, чтобы получить обратную матрицу.
$$A' = \pmatrix{12 & -21 & 15 \\ 11 & -18 & 13 \\ -7 & 12 & -8}$$
$$A^{-1} = \frac{(A')^T}{\det A} = \frac 1{3}\pmatrix{12 & 11 & -7 \\ -21 & -18 & 12 \\ 15 & 13 & -8}$$
