## Замена базиса
Основа задачи такова: у нас есть какой-то базис/система координат $(\overline{e_1}; \overline{e_2}; \ldots)$, и вектора $\overline{a}, \overline{b}, \ldots$, заданные в этом базисе. Затем нам дают новый базис: $(\overline{e_1'}; \overline{e_2'}; \ldots)$, и говорят представить известный нам вектор  $\overline{a}$ в *новом* базисе.

(Чтобы не выливать в файлик тучу математических символов, будем считать, что базис состоит из двух векторов $(\overline{e_1}; \overline{e_2})$, но на деле такая процедура работает для сколь угодного количества векторов)

И как же это сделать? Разберем идею - у нас есть новый базис, но он не может находится просто в вакууме (иначе нам не от чего отталкиваться в решении задачи) - этот *новый базис мы выразим через вектора старого базиса*. Мы знаем как был записан вектор в старом базисе, и мы знаем как записан новый базис через старый - значит вектор можно выразить через новый базис как линейную комбинацию новых векторов.
$$\overline{a} = a_1' \overline{e'_1} + a_2' \overline{e'_2} = (a_1'\alpha_1 + a_2'\alpha_2)\overline{e_1} + (a_1'\beta_1 + a_2'\beta_2)\overline{e_2}$$
Разберем в первую очередь решение через системы уравнений.

Для начала запишем векторы нового базиса через старый - раз это базис, значит любой вектор в нем можно представить как линейную комбинацию базисных векторов:
$$\array{\overline{e_1'} = \alpha_1 \overline{e_1} + \beta_1\overline{e_2} \\ \overline{e_2'} = \alpha_2 \overline{e_1} + \beta_2\overline{e_2}}$$
Для каждого вектора нового базиса находим значения $\alpha, \beta$. Получили теперь записи новых векторов в старом базисе. 
Точно так же и для вектора - представим его как линейную комбинацию базисных векторов:
$$\array{\overline{a} = a_1 \overline{e_1} + a_2 \overline{e_2} \\ \overline{a} = a_1' \overline{e'_1} + a_2' \overline{e'_2}}$$
Здесь $(a_1, a_2)$ и $(a_1', a_2')$ - координаты вектора $\overline a$ в старом и новом базисе соответственно.
Подставляя линейные комбинации новых базисных векторов в уравнение выше (в новом базисе) и перегруппировывая, получим запись вектора в новом базисе, но через старые базисные векторы.
$$\overline{a} = a_1'(\alpha_1 \overline{e_1} + \beta_1\overline{e_2}) + a_2'(\alpha_2 \overline{e_1} + \beta_2\overline{e_2})$$
$$\overline{a} = (a_1'\alpha_1 + a_2'\alpha_2)\overline{e_1} + (a_1'\beta_1 + a_2'\beta_2)\overline{e_2}$$
Таким образом у нас получилась зависимость между координатами вектора в старом базисе и в новом. Чтобы найти новые координаты, необходимо решить систему уравнений.
$$\cases{a_1 = a_1'\alpha_1 + a_2'\alpha_2 \\ a_2 = a_1'\beta_1 + a_2'\beta_2}$$
Координаты $(a_1', a_2')$ и будут записью вектора $\overline a$ в новом базисе.
Можно найти эти координаты $(a_1', a_2')$ методом Крамера - проблема такого решения, что если бы векторов было несколько, для каждого пришлось решать Крамером по-своему. А с помощью обратной матрицы - то, что изучим дальше - решение быстро применяется сразу для всех векторов (решение направлено на базис, а не на вектор).

Эту систему можно записать в виде матричного уравнения:
$$\cases{a_1 = a_1'\alpha_1 + a_2'\alpha_2 \\ a_2 = a_1'\beta_1 + a_2'\beta_2} \Rightarrow \left(\matrix{a_1 \\ a_2}\right) = \left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)\left(\matrix{a_1' \\ a_2'}\right)$$
Матрица в середине $\left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)$ называется *матрицей перехода* от старого базиса к новому. Но сейчас наше уравнение показывает как получить старые координаты из новых, а нам нужно наоборот! Поэтому "поделим на эту матрицу" - умножим каждую сторону на обратную матрицу:
$$\left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)^{-1}\left(\matrix{a_1 \\ a_2}\right) = \left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)^{-1}\left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)\left(\matrix{a_1' \\ a_2'}\right)$$
$$\left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)^{-1}\left(\matrix{a_1 \\ a_2}\right) = \left(\matrix{a_1' \\ a_2'}\right)$$
В итоге вся наша задача сводится к нахождению обратной матрицы и перемножению матриц, и с помощью старых координат можно будет получить новые.

В общем случае, если базис задан векторами:
$$\array{\overline{e_1'} = a_{11} \overline{e_1} + a_{21} \overline{e_2} + \ldots + a_{n1} \overline{e_n} \\ \overline{e_2'} = a_{12} \overline{e_1} + a_{22} \overline{e_2} + \ldots + a_{n2} \overline{e_n} \\ \vdots \\ \overline{e_n'} = a_{1n} \overline{e_1} + a_{2n} \overline{e_2} + \ldots + a_{nn} \overline{e_n}}$$
То матрица перехода будет выглядеть следующим образом:
$$\left(\matrix{a_{11} & a_{12} & \ldots & a_{1n} \\ a_{21} & a_{22} & \ldots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{n1} & a_{n2} & \ldots & a_{nn}}\right)$$
Мы заполняем коэффициенты для каждого вектора базиса в столбики. Коэффициенты вектора $\overline{e_1'}$ идут в первый столбик, и т.д.

## Переход к новой системе координат
Система координат от базиса отличается лишь наличием точки отсчета. Скажем что у новой системы координат коодинаты точки отсчета - $O$. Тогда координаты для вектора в новом векторе должны учитывать и расстояние между двумя точками отсчета.
$$\cases{a_1 = a_1'\alpha_1 + a_2'\alpha_2 + O_1 \\ a_2 = a_1'\beta_1 + a_2'\beta_2 + O_2}$$
$$\left(\matrix{a_1 \\ a_2}\right) = \left(\matrix{\alpha_1 & \alpha_2 \\ \beta_1 & \beta_2}\right)\left(\matrix{a_1' \\ a_2'}\right) + \left(\matrix{O_1 \\ O_2}\right)$$
Помимо обычного вектора, который получается после замены базиса, его еще нужно сместить на расстояние новой системы координат относительно старой. Координаты $(O_1; O_2)$ - координаты точки отсчета новой системы координат *в старой системе координат*!
![[algem-14-1.png]]
## Параллельный перенос и поворот
В случае с параллельным переносом все просто - это будто наша система координат просто переместилась, но базис остался неизменным. Если мы сместили вектор $\overline{a}(a_1; a_2; \ldots)$ параллельным переносом на вектор $\overline{v}(v_1; v_2; \ldots)$, то координаты будут связаны следующим равенством: $$\overline {a} = \overline {a'} + \overline v \Leftrightarrow \cases{a_1 = a_1' + v_1 \\ a_2 = a_2' + v_2 \\ \ldots}$$
Поворот будет чуть сложнее. Здесь мы считаем, что наша система координат является ***правой*** декартовой прямоугольной (ортонормированный базис). Скажем, мы поворачиваем оригинальную систему координат против часовой стрелки на угол $\varphi$ - как тогда изменятся координаты вектора $\overline a$ в новой системе координат?
Рассмотрим, чему будет равен базис $(\overline{e_1'}; \overline{e_2'})$ после поворота базиса $(\overline{e_1}; \overline{e_2})$ на угол $\varphi$.
Первый базисный вектор будет повернут относительно вектора $\overline{e_1}$ с помощью множителей косинуса и синуса
![[algem-14-2.png|400]]
$$\overline{e_1'} = \cos \varphi \cdot \overline{e_1} + \sin \varphi \cdot \overline{e_2}$$
Второй базисный вектор можно представить либо прибавлением $90^\circ$ к углу, либо переворотом системы координат *по часовой стрелке* на $90^\circ$ и умножением на косинус/синус.
Случай 1:
$$\overline{e_2'} = \cos(\varphi + 90^\circ) \cdot \overline{e_1} + \sin(\varphi + 90^\circ) \cdot \overline{e_2}$$
$$\overline{e_2'} = -\sin \varphi \cdot \overline{e_1} + \cos \varphi \cdot \overline{e_2}$$
![[algem-14-3.png|400]]
Случай 2:
$$\overline{e_2'} = \sin \varphi \cdot (-\overline{e_1}) + \cos \varphi \cdot \overline{e_2}$$
![[algem-14-4.png|400]]

В любом случае, у нас получаются два базисных вектора:
$$\array{\overline{e_1'} = \cos \varphi \cdot \overline{e_1} + \sin \varphi \cdot \overline{e_2} \\ \overline{e_2'} = -\sin \varphi \cdot \overline{e_1} + \cos \varphi \cdot \overline{e_2}}$$
Проводя операции что были описаны выше в этом билете, получаем уравнения для координат вектора $\overline a$:
$$\cases{a_1 = a_1' \cos \varphi - a_2' \sin \phi \\ a_2 = a_1' \sin \varphi + a_2' \cos \varphi}$$
Вот и все вращение!

## Пример задачи
Условие: найти координаты вектора $\overline a(5;3)$, записанного в стандартном базисе $(\overline i; \overline j)$, в новом базисе $(\overline{e_1}; \overline{e_2})$. $(\overline{e_1} =2\overline i + 2\overline j, \overline{e_2} = -\overline i + \overline j)$

Решение: выразим новые координаты вектора через старый базис (необязательный шаг - можно сразу записывать матрицу перехода - но для практики пойдет):
$\overline a = 5\overline i + 3\overline j = a_1'\overline{e_1} + a_2'\overline{e_2} = a_1'(2\overline i + 2\overline j) + a_2'(-\overline i + \overline j)$
$\overline a = (2a_1'-a_2')\overline i + (2a_1' + a_2')\overline j$

Составим матрицу перехода:
$$A = \left(\matrix{2 & -1 \\ 2 & 1} \right)$$
Тогда уравнение получается:
$$\left(\matrix{5\\3}\right) = \left(\matrix{2 & -1 \\ 2 & 1} \right)\left(\matrix{a'_1 \\ a_2'}\right)$$
Умножаем на обратную матрицу:
$$\left(\matrix{2 & -1 \\ 2 & 1} \right)^{-1}\left(\matrix{5\\3}\right) = \left(\matrix{a'_1 \\ a_2'}\right)$$
Посчитаем обратную матрицу. Для этого найдем определитель матрицы:
$$|A| = \left|\matrix{2 & -1 \\ 2 & 1} \right| = 2+2=4$$
Теперь составим матрицу миноров и составляем матрицу алгебраических дополнений...
$$M = \left(\matrix{1 & 2 \\ -1 & 2}\right);\ \ \ \ \ \ \ \  A_* = \left(\matrix{1 & -2 \\ 1 & 2}\right)$$
Транспонируем эту матрицу и делим на определитель...
$$A_*^T = \left(\matrix{1 & 1 \\ -2 & 2}\right); \ \ \ \ \ \ \ \ \ \ A^{-1} = \frac{1}{4} \left(\matrix{1 & 1 \\ -2 & 2}\right)$$
Поподробнее о нахождении обратной матрицы будет написано в другом билете.
Можем перепроверить, правильно ли нашли обратную матрицу, перемножив их:
$$\frac{1}{4} \left(\matrix{1 & 1 \\ -2 & 2}\right) \left(\matrix{2 & -1 \\ 2 & 1} \right) = \frac{1}{4} \left(\matrix{2+2&-1+1\\-4+4&2+2}\right) = \left(\matrix{1 & 0 \\ 0 & 1}\right)$$
При умножении получилась единичная матрица, значит все верно.

Ну, теперь просто умножаем:
$$\frac 14 \left(\matrix{1 & 1 \\ -2 & 2}\right) \left(\matrix{5\\3}\right) = \frac 14 \left(\matrix{5+3\\-10+6}\right) = \left(\matrix{2\\-1}\right)$$
Получили, что в новом базисе вектор $\overline a = 5\overline i + 3\overline j$ будет равен $\overline a = 2\overline{e_1} - \overline{e_2}$.

В качестве второго способа, можем решить систему способом Крамера.
$\overline a = (2a_1'-a_2')\overline i + (2a_1' + a_2')\overline j$
$$\cases{5 = 2a_1' - a_2' \\ 3 = 2a_1' + a'_2}$$
Найдем нужные определители:
$\Delta = \left|\matrix{2 & -1 \\ 2 & 1}\right| = 2+2=4$
$\Delta_1 = \left|\matrix{5 & -1 \\ 3 & 1}\right| = 5+3 = 8$
$\Delta_2 = \left|\matrix{2 & 5 \\ 2 & 3}\right| = 6-10 = -4$
Найдем $a_1$ и $a_2$:
$a_1 = \frac{\Delta_1}{\Delta} = \frac 84 = 2$
$a_2 = \frac{\Delta_2}{\Delta} = \frac{-4}4 = -1$
Получаем точно такой же результат: $\overline a = 2\overline{e_1} - \overline{e_2}$.

---
Условие: найдите координаты вектора $\overline a = 2\overline i + \overline j$ в новой системе координат, что была повернута на угол $\varphi = \frac \pi 4$ против часовой стрелки.

Решение: как и раньше, составляем матричное уравнение:
$$\left(\matrix{2 \\ 1}\right) =\left(\matrix{\cos \varphi & -\sin \varphi \\ \sin \varphi & \cos \varphi}\right) \left(\matrix{a'_1 \\ a_2'}\right)$$
$$\left(\matrix{\cos \varphi & \sin \varphi \\ -\sin \varphi & \cos \varphi}\right)  \left(\matrix{2 \\ 1}\right) =\left(\matrix{a'_1 \\ a_2'}\right)$$
$$\left(\matrix{2\cos \varphi + \sin \varphi \\ -2\sin \varphi + \cos \varphi}\right) =\left(\matrix{a'_1 \\ a_2'}\right)$$
$$\cases{a'_1 = 2\cos \varphi + \sin \varphi \\ a'_2 = -2\sin \varphi + \cos \varphi}$$
Подставляем угол $\varphi$ и считаем:
$$\cases{a'_1 = 2\cos \frac \pi 4 + \sin \frac \pi 4 = \frac{3\sqrt 2}2 \\ a'_2 = -2\sin \frac \pi 4 + \cos \frac \pi 4 = -\frac{\sqrt 2}2}$$
$$\overline{a'}\left (\frac{3\sqrt 2}2; -\frac{\sqrt{2}}2\right)$$
