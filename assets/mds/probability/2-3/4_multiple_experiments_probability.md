- [Биномиальная схема](#биномиальная-схема)
- [Пуассоновская схема (вариация по вероятностям)](#пуассоновская-схема-вариация-по-вероятностям)
- [Полиномиальная схема (вариация по исходам)](#полиномиальная-схема-вариация-по-исходам)
- [Пуассоновская схема (вариация по вероятностям)](#пуассоновская-схема-вариация-по-вероятностям)
- [Бонус - наивероятнейшее событие](#бонус---наивероятнейшее-событие)

## Биномиальная схема
Дано испытание $A$, и с вероятностью $p$ испытание заканчивается успехом, с вероятностью $q$ испытание проваливается ($p+q=1$). Проведем $n$ раз это испытание. Какова вероятность, что за $n$ раз испытание выполнилось ровно $m$ раз?

Для получения вероятности нужно учесть $m$ успешных выполнений, $(n-m)$ провалов, и всевозможные перестановки успех-провал в испытаниях:
$$P_n(m) = C^m_n p^mq^{n-m}$$
Рассмотрим следующее перемножение скобок:
$$\underbrace{(px+q)(px+q)\ldots(px+q)}_{n \text{ раз}}$$
Вероятность $m$ успешных выполнений равна коэффициенту при $x^m$, что и будет равно $P$ выше, если посчитать этот коэффициент через бином Ньютона.

Самый простой пример этой задачи - подброс монетки. Подбрасывая монетку 5 раз, какова вероятность выпадения двух орлов?
$$P_5(2) = C^2_5 \left(\frac12\right)^2\left(\frac12\right)^{3} = \frac{10}{32}$$
Начнем варьировать эту схему по параметрам.
## Пуассоновская схема (вариация по вероятностям)
Дано испытание $A$, и при $i$-том опыте испытание заканчивается успехом с вероятностью $p_i$, и проваливается с вероятностью $q_i$. Какова вероятность, что за $n$ раз испытание закончилось успехом ровно $m$ раз?

Эта схема отличается от прошлой тем, что между опытами меняются вероятности. Идея подсчета с перемножением скобок остается такой же. Минус - мы не сможем воспользоваться биномом Ньютона, поэтому мы называем это перемножение *производящей функцией*, и говорим, что вероятность будет равна коэффициенту при степени $x^m$:
$$\underbrace{(p_1x+q_1)(p_2x+q_2)\ldots(p_nx+q_n)}_{n \text{ раз}}$$
Чтобы найти вероятность, нужно просто перебрать все $C^m_n$ способов выбрать левое слагаемое $m$ раз и сложить их вместе.

Пример задачи: три выстрела по мишени с вероятностями $p_1, p_2, p_3$ каждый. Найти вероятность, что будет лишь одно попадание из трех.

Значит, нужно найти коэффициент при $x^1$, или же выбрать левое слагаемое только один раз.
$$(p_1x+q_1)(p_2x+q_2)(p_3x+q_3) = \ldots + (p_1q_2q_3+q_1p_2q_3+q_1q_2p_3)x+\ldots$$
Ответ: $p_1q_2q_3+q_1p_2q_3+q_1q_2p_3$.
## Полиномиальная схема (вариация по исходам)
Дано испытание $A$, и с вероятностью $p_1$ испытание заканчивается исходом $A_1$, с вероятностью $p_2$ испытание заканчивается исходом $A_2$, ..., с вероятностью $p_m$ испытание заканчивается исходом $A_m$ ($p_1+\ldots+p_m=1$). Какова вероятность, что за $n$ раз испытание закончится с исходами $A_1, \ldots, A_m$ ровно $k_1, \ldots, k_m$ раз соответственно? ($k_1 + \ldots + k_m = n$)

Здесь вариация по исходам - раньше исхода было два (успех и провал), а сейчас их $n$ штук. Идея нахождения? Вся та же - раскрываем скобки:
$$\underbrace{(p_1x_1+p_2x_2+\ldots+p_mx_m)\ldots(p_1x_1+p_2x_2+\ldots+p_mx_m)}_{n \text{ раз}}$$
Найти вероятность завершения испытания $k_1$ раз исходом $A_1$, $k_2$ раз исходом $A_2$, ..., $k_m$ раз исходом $A_m$ - посмотреть на коэффициент при множителе $x_1^{k_1}x_2^{k_2}\ldots x_m^{k_m}$. К счастью, этот коэффициент легко считается по полиномиальному коэффициенту:
$$P_n(k_1, k_2, \ldots, k_m) = \frac{n!}{k_1!k_2!\ldots k_m!} p_1^{k_1}p_2^{k_2}\ldots p_m^{k_m}$$
## Обобщенная схема (вариация по всему!!)
Дано испытание $A$, в $i$-том опыте с вероятностью $p_{i1}$ испытание заканчивается исходом $A_1$, с вероятностью $p_{i2}$ испытание заканчивается исходом $A_2$, ..., с вероятностью $p_{im}$ испытание заканчивается исходом $A_m$ ($p_{1n}+\ldots+p_{mn}=1$). Какова вероятность, что за $n$ раз испытание закончится с исходами $A_1, \ldots, A_m$ ровно $k_1, \ldots, k_m$ раз соответственно? ($k_1 + \ldots + k_m = n$)

Ну и чего таить, тут тоже просто перемножение скобок (оно без явной формулы, а через производящую функцию):
$$\underbrace{(p_{11}x_1+p_{12}x_2+\ldots+p_{1m}x_m)\ldots(p_{n1}x_1+p_{n2}x_2+\ldots+{p_{mn}}x_m)}_{n \text{ раз}}$$
Тогда вероятность будет равна коэффициенту при множителе $x_1^{k_1}x_2^{k_2}\ldots x_m^{k_m}$.
В таких задачах может быть удобно записать скобки в столбик, для простоты выбора.

Пример: 3 студента сдают экзамен, за который могут получить 5, 4 или 3 балла. Какова вероятность, что все они получат разные оценки, вероятность получения каждой оценки для каждого студента приведена в таблице ниже?

| Оценка    | 5   | 4   | 3   |
| --------- | --- | --- | --- |
| Студент 1 | 0.3 | 0.2 | 0.5 |
| Студент 2 | 0.5 | 0.4 | 0.1 |
| Студент 3 | 0.2 | 0.3 | 0.5 |

Для решения записываем скобки:
$$\array{(0.3x_1 + 0.2x_2 + 0.5x_3) \\ (0.5x_1 + 0.4x_2 + 0.1x_3) \\ (0.2x_1 + 0.3x_2 + 0.5x_3)}$$
Нужно взять все способы получить $x_1x_2x_3$. Хоть явной формулы для обобщенной схемы и нет, мы все равно можем использовать полиномиальный коэффициент для определения количества слагаемых в ответе:
$$\frac{3!}{1!1!1!}=6$$
А вот и все эти способы: $123, 132, 213, 231, 312, 321$.
$$\array{(0.3\cdot 0.4 \cdot 0.5 + 0.3 \cdot 0.1 \cdot 0.3 + 0.2 \cdot 0.5 \cdot 0.5 + \ \\ \ + 0.2 \cdot 0.1 \cdot 0.2 + 0.5 \cdot 0.5 \cdot 0.3 + 0.5 \cdot 0.4 \cdot 0.2)x_1 x_2 x_3}$$
Складывая, получим вероятность:
$$P(1,1,1) = \frac{119}{500}=0.238$$
## Бонус - наивероятнейшее событие
Для первой (биномиальной) схемы есть понятие наивероятнейшего количества успехов $m^*$ - такого, что вероятность количества+1 или вероятность количества-1 будет меньше.
$$P_n(m^*-1) < P_n(m^*) > P_n(m^*+1)$$
Это значение $m^*$ можно найти из неравенства, доказательство которого мне пока расписывать лень:
$$pn - q \leq m^* \leq pn + p$$
В силу того, что $m^*$ - целое число, а длина этого отрезка - единичная, $m^*$ либо единственно, либо принимает два значения на концах этого отрезка.

Так, например, какое наивероятнейшее количество выпадаемых орлов при подбрасывании монетки 10 раз?
$$0.5 \cdot 10 - 0.5 \leq m^* \leq 0.5\cdot 10 + 0.5 \Rightarrow m^* = 5$$
Ответ: 5 (и вероятность равна $P_{10}(5) = C^5_{10} \cdot (0.5)^{10} = 63/256$)